ライティング

上記の関数で描画したシーンは、光がないためフラットに見えます。
向きに関係なく、面が等しい場合の色。
よりリアルに見えるシーンを作成するには、照明を有効にして、正しい場所に照明を配置する必要があります。
正しく照らされたシーンを作成するのは簡単ではありませんが、効果は非常に優れています。



照明を有効にするには、次の関数を使用できます
・d3d_set_lighting(enable) 
　　照明の使用を有効または無効にします。



照明を使用する場合、ポリゴンの頂点ごとに色が決定されます。
次に、内部ピクセルの色は、これらの頂点の色に基づいています。
これを行うには 2 つの方法があります。
ポリゴン全体を同じ色にするか、ポリゴン上で色を滑らかに補間します。
デフォルトのスムーズ シェーディングが使用されます。

これは、次の関数を使用して変更できます。
・d3d_set_shading(smooth) 
　　スムーズ シェーディングを使用するかどうかを設定します。



照明を使用するには、明らかに照明を定義する必要があります。
ディレクショナル ライト (太陽など) と位置ライトの 2 つの異なるライトが存在します。
ライトには色があります。 (鏡面反射ではなく、拡散光のみをサポートします。)
通常、使用できるハードウェア ライトは 8 つだけなので、
以下の関数を使用して、シーン内のすべてのライトだけでなく、
「アクティブな」ライトを定義および管理する必要があります。

ライトを定義して使用するために、次の関数が存在します。
・d3d_light_define_direction(ind,dx,dy,dz,col) 
　　指向性ライトを定義します。 
　　ind はライトのインデックスです (小さな正の数を使用してください)。
 　　(dx,dy,dz) は光の方向です。
　　 col はライトの色です (多くの場合、c_white を使用します。
　　この関数はライトをオンにしません。

・d3d_light_define_point(ind,x,y,z,range,col) 
　　ポイント ライトを定義します。 
　　ind はライトのインデックスで、小さな正の数を使用します)。 
　　(x,y,z) はライトの位置です。
　　範囲は、光がどれだけ遠くまで輝くかを示します。
　　この範囲では光の強度が低下します。
 　　col は光の色です。
　　この機能ではライトは点灯しません。

・d3d_light_enable(ind,enable) 
　　ライト番号 ind を有効 (true) または無効 (false) にします。



最後の機能は、周囲光と呼ばれるものを制御するためのものです。
環境光は、光がないときに得られる光です。
それは事実上、シーンの暗闇の色と明るさです。

このライトを制御するには、次のコマンドを使用します。
・d3d_light_define_ambient( color ) 
　　デフォルトの色は $000000 (黒) です



オブジェクトが光を反射する方法は、
光の方向とサーフェスの法線との間の角度、
つまりサーフェスから離れた方向を指すベクトルによって異なります。
したがって、ライティングされたオブジェクトを作成するには、
頂点の位置だけでなく法線も指定する必要があります。

このため、プリミティブの頂点を定義するために 4 つの追加関数を使用できます。
・d3d_vertex_normal(x,y,z,nx,ny,nz) 
　　頂点 (x,y,z) を法線ベクトル (nx,ny,nz) でプリミティブに追加します。

・d3d_vertex_normal_color(x,y,z,nx,ny,nz,col,alpha) 
　　頂点 (x,y,z) をプリミティブに追加し、
　　法線ベクトル (nx,ny,nz) と独自の色とアルファ値を使用します。 .

・d3d_vertex_normal_texture(x,y,z,nx,ny,nz,xtex,ytex) 
　　頂点 (x,y,z) をプリミティブに、
　　法線ベクトル (nx,ny,nz) と位置 (xtex,ytex) で追加します。
　　テクスチャで、前に設定した色とアルファ値とブレンドします。

・d3d_vertex_normal_texture_color(x,y,z,nx,ny,nz,xtex,ytex,col,alpha) 
　　法線ベクトル (nx,ny,nz) と位置 ( xtex,ytex) をテクスチャに組み込み、
　　独自の色とアルファ値とブレンドします。



描画できる基本的な形状では、法線が自動的に正しく設定されることに注意してください。

